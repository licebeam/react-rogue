(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(t,e,n){t.exports=n(34)},27:function(t,e,n){},34:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),i=n(10),o=n.n(i),c=(n(27),n(11)),l=n(2),u=n(12),s=n(13),d=n(18),m=n(14),f=n(19),p=30,h=60*p/2,y=n(3),g=n(4);function w(){var t=Object(y.a)(["\n  display: flex;\n  flex-direction: column;\n  align-content: center;\n  justify-content: center;\n  text-align: center;\n  z-index: 0;\n  height: ",";\n  width: ",";\n  background-color: ",";\n    color: ",";\n  &:hover{\n    opacity: .8;\n  }\n  .sprite-image{\n    object-fit: cover;\n    height: ",";\n    width: ",";\n  }\n"]);return w=function(){return t},t}function v(){var t=Object(y.a)(["\n  display: grid;\n  grid-template-columns: ",";\n"]);return v=function(){return t},t}var k=g.a.div(v(),"repeat(".concat(p,", ").concat(16,"px)")),R=g.a.div(w(),"".concat(16,"px"),"".concat(16,"px"),function(t){switch(t.tile){case"wall":return"black";case"ground":return"green";case"dirt":return"burlywood";case"rock":return"grey";case"tree":return"darkgreen";case"player":case"rat":case"cat":return"black";case"apple":case"orange":case"stone":return"green"}},function(t){switch(t.tile){case"wall":return"grey";case"ground":return"darkgreen";case"dirt":return"brown";case"rock":return"darkgrey";case"tree":return"green";case"player":return"orange";case"rat":return"red";case"cat":return"brown";case"apple":return"red";case"orange":return"orange";case"stone":return"brown"}},"".concat(16,"px"),"".concat(16,"px")),E={wall:{name:"wall",char:"X",img:null},ground:{name:"ground",char:"v",img:null},dirt:{name:"dirt",char:"^",img:null},tree:{name:"tree",char:"T",img:null},rock:{name:"rock",char:"M",img:null},portal:{name:"portal",char:"Z",img:null}},b=[{name:"apple",char:"9",img:null},{name:"orange",char:"0",img:null},{name:"stone",char:".",img:null},{name:"sword",char:"/",img:null}],O=n(17),S=n(1),M=function(t,e){var n=[],r=Object(O.NewDungeon)({width:30,height:30,minRoomSize:10,maxRoomSize:10}).map(function(t,e){return t.map(function(t,n){return function(t,e,n){var r=n>=1?60*n/2-1:n;switch(t){case 0:return{id:e+1+r,tile:E.ground};case 1:return{id:e+1+r,tile:E.wall};default:return{id:e+1+r,tile:E.ground}}}(t,n,e)})});n.push(r);var a=Object(l.a)(new Set(Object(S.flattenDeep)(n.filter(function(t){return t}))));return a=Object(S.flattenDeep)(a),a=j(a,"portal",e),a=I(a,"rock"),a=I(a,"tree"),a=I(a,"rock"),a=I(a,"tree"),a=I(a,"dirt"),a=I(a,"dirt"),a=T(a),a=T(a),a=T(a)},I=function(t,e){return t.map(function(t){var n=Math.floor(Math.random()*(h-1+1))+1;return"wall"!==t.tile.name&&(t.id===n+1||t.id===n-1||t.id===n)?{id:t.id,tile:E[e]}:t})},T=function(t){return t.map(function(t){var e=t.tile.name,n=Math.floor(Math.random()*b.length)+0,r=Math.floor(Math.random()*h)+1;return"wall"!==t.tile.name&&(t.id===r+1||t.id===r-1||t.id===r)?{id:t.id,tile:E[e],contains:b[n]}:t})},j=function t(e,n,r){var a=e,i=a.filter(function(t){return"ground"===t.tile.name}),o=i[Math.floor(Math.random()*i.length)],c=a.indexOf(o);return o.contains||o.id===r?t(e,n):(a[c].tile=E[n],a)},A=function(t,e,n,r,a){var i=r.find(function(e){return e.id===t.id+n}),o=e.find(function(t){return t.id===i.id&&t.roomId===a});return e.map(function(e){return!i||e.id!==t.id||function(t){switch(t){case"tree":case"wall":return!0}}(i.tile?i.tile.name:i.contains.name)||o||(e.id+=n),e})},x=[{type:"rat",char:"~o",img:null},{type:"cat",char:"~m",img:null}],D=function(t){function e(){var t,n;Object(u.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(a)))).state={currentRoom:[],currentRoomId:0,allRooms:[],allEntities:[],loading:!1,currentTurn:0,playerTurn:!0,othersTurn:!1,currentTile:"",keyPress:!1},n.changeRooms=function(){n.state.currentRoomId<n.state.allRooms.length-1&&n.setState({currentRoomId:n.state.currentRoomId+1,loading:!0},function(){n.setState({currentRoom:n.state.allRooms[n.state.currentRoomId],loading:!1})})},n.generateRooms=function(t,e){var r=n.state.allEntities,a=[],i=[],o=0,c=a.length&&a[o].find(function(t){return"portal"===t.tile.name}).id||null,l=r.length&&r.find(function(t){return"player"===t.entity.type}).id||null;for(o=0;o<e;o++)a.push({roomId:o,room:M(t,c,l)});return n.setState({allRooms:a},function(){var t=0;for(t=0;t<e;t++)0===t&&i.push(n.addPlayerOnStart(n.state.allRooms[t].room)),i.push(n.entityGenerator(n.state.allRooms[t].room,t));n.setState({allEntities:Object(S.flatten)(i)})})},n.fireKey=function(t,e,r){var a=n.state,i=a.allEntities,o=a.currentRoom,c=a.currentRoomId,l=a.keyPress;r&&n.setState({keyPress:!0});var u=i.find(function(t){return"player"===t.entity.type});("ArrowUp"===e||"ArrowUp"===t.key&&!1===l)&&(n.setState({editEntities:A(u,i,-p,o.room,c)}),n.updateTurn()),("ArrowDown"===e||"ArrowDown"===t.key&&!1===l)&&(n.setState({editEntities:A(u,i,p,o.room,c)}),n.updateTurn()),("ArrowRight"===e||"ArrowRight"===t.key&&!1===l)&&(n.setState({editEntities:A(u,i,1,o.room,c)}),n.updateTurn()),("ArrowLeft"===e||"ArrowLeft"===t.key&&!1===l)&&(n.setState({editEntities:A(u,i,-1,o.room,c)}),n.updateTurn())},n.releaseKeys=function(){n.setState({keyPress:!1})},n.updateTurn=function(){var t=n.state,e=t.allEntities,r=t.currentRoom,a=e.find(function(t){return"player"===t.entity.type}),i=r.room.find(function(t){return t.id===a.id});n.setState({playerTurn:!n.state.playerTurn,currentTurn:n.state.currentTurn+1,currentTile:i})},n.entityGenerator=function(t,e){return t.map(function(t){var n=Math.floor(Math.random()*x.length)+0,r=Math.floor(Math.random()*h)+1;return"wall"!==t.tile.name&&t.id===r?{roomId:e,id:t.id,entity:x[n]}:null}).filter(function(t){return t})},n.addPlayerOnStart=function(t){var e=t.filter(function(t){return"ground"===t.tile.name}),r=e[Math.floor(Math.random()*e.length)];if(!r.contains)return{roomId:n.state.currentRoomId,id:r.id,entity:{type:"player",char:"@",img:null}}},n.produceEntityOnScreen=function(t){var e=n.state,r=e.allEntities,a=e.currentRoomId,i=r.find(function(e){return e&&e.id&&e.id===t&&a===e.roomId&&"player"!==e.type?e.entity:e&&e.id&&e.id===t&&"player"===e.type?e.entity:void 0});if(i)return i},n}return Object(f.a)(e,t),Object(s.a)(e,[{key:"componentDidMount",value:function(){var t=this;this.setState({rooms:this.generateRooms(h,11)},function(){t.setState({currentRoom:t.state.allRooms[t.state.currentRoomId]})}),document.addEventListener("DOMContentLoaded",function(){window.addEventListener("keydown",function(e){t.fireKey(e,!1,!0)}),window.addEventListener("keyup",function(e){t.releaseKeys(e)})})}},{key:"componentDidUpdate",value:function(t,e){var n=this.state,r=n.allEntities,a=n.currentRoom;if((r.length&&r.find(function(t){return"player"===t.entity.type}).id)===(a&&a.room&&a.room.find(function(t){return"portal"===t.tile.name}).id)&&!1===this.state.loading&&this.changeRooms(),e.currentRoomId!==this.state.currentRoomId){var i=r.find(function(t){return"player"===t.entity.type}),o=r.indexOf(i);this.setState({allEntities:Object.assign(Object(l.a)(r),Object(c.a)({},o,{roomId:this.state.currentRoomId,id:i.id,entity:i.entity}))})}}},{key:"render",value:function(){var t=this,e=this.state,n=e.currentRoom,r=e.currentTurn,i=e.currentTile,o=e.playerTurn;return a.a.createElement("div",{className:"App"},a.a.createElement(k,{className:"tiles"},n&&n.room?n.room.map(function(e){if(t.produceEntityOnScreen(e.id)){var n=t.produceEntityOnScreen(e.id);return a.a.createElement(R,{tile:n.entity.type,key:n.id+"ent"+Math.random()},n.entity.img?a.a.createElement("img",{className:"sprite-image",src:n.entity.img,alt:""}):n.entity.char)}return e.contains?a.a.createElement(R,{tile:e.contains.name,key:e.id+"tile"+Math.random()},e.contains.img?a.a.createElement("img",{className:"sprite-image",src:e.contains.img,alt:""}):e.contains.char):a.a.createElement(R,{tile:e.tile.name,key:e.id+"normal"+Math.random()},e.tile.img?a.a.createElement("img",{className:"sprite-image",src:e.tile.img,alt:""}):e.tile.char)}):null),a.a.createElement("div",null,r),a.a.createElement("div",null,"player: ",o.toString()),a.a.createElement("div",null,"currentTile:",JSON.stringify(i)),a.a.createElement("button",{onClick:function(){return t.fireKey(!1,"ArrowUp",!1)}},"up"),a.a.createElement("button",{onClick:function(){return t.fireKey(!1,"ArrowDown",!1)}},"Down"),a.a.createElement("button",{onClick:function(){return t.fireKey(!1,"ArrowLeft",!1)}},"Left"),a.a.createElement("button",{onClick:function(){return t.fireKey(!1,"ArrowRight",!1)}},"Right"))}}]),e}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(D,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[22,1,2]]]);
//# sourceMappingURL=main.ccfccf1c.chunk.js.map